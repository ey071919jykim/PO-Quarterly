COM ***********************************************************
COM  SCRIPT NAME:  S02e_Import_SRM_Raw
COM  SCRIPT DESC:  Import SRM PO and SC table from Snowflake
COM  CREATED DATE: 5/26/2022
COM  CREATED BY:   Marion Pacuri
COM  CALLED BY:    A00_Master
COM  FILES OUT:    SRM_PO_CURR.FIL
COM                SRM_SC_CURR.FIL
COM ***********************************************************

COM Set folder
SET FOLDER /Tables/Source

COM Assign v_COMMENT variable. Import only if test was selected.
v_COMMENT = "COMMENT"
IF v_bootJ <> 0 v_COMMENT = ""

%v_COMMENT%
COM Import PO data from Snowflake
ACCESSDATA64 CONNECTOR NAME "Snowflake" TO "SRM_PO_CURR.fil" CHARMAX 50 MEMOMAX 100 
 %v_SQL_source%
 SQL_QUERY( 
    SELECT RGN_ORIG_SYS_ID, PRCH_DOC_ID, PRCH_DOC_ITM_ID, SCHED_LINE_ID, PRCH_DOC_ITM_LMT_GUID, EFF_DT, EXP_DT, RGN_SBU_ID, BW_ORIG_SYS_ID, PRCH_DOC_GUID, TRANS_TYP_CD, POST_DT, PRCH_DOC_NM, VEND_BUS_PARTNER_ID, CO_CD, SRM_LOGC_SYS_ID, BACKEND_LOGC_SYS_ID, FIN_LOGC_SYS_ID, DOC_CRNCY_ID, PRCH_INFO_FROM_DT, PRCH_INFO_TO_DT, INCOTERM_CD, INCOTERM_DESC, GR_IND, INVC_RCPT_IND, GR_INVC_VRFY_IND, ERS_IND, PRCH_DOC_QTY, PROC_STA_CD, RDD_DT, PRCH_DOC_ITM_GUID, PROD_GUID, ORD_PROD_ID, PROD_DESC, PROD_CTGY_GUID, PROD_CTGY_ID, EXT_CTGY_NM, CATL_ID, PROD_CTGY_CD, BASE_UOM_CD, ORD_BASE_UOM_QTY, CNFRM_BASE_UOM_QTY, INVC_BASE_UOM_QTY, PRC_UNIT_ORD_UOM_QTY, PRCH_DOC_ITM_NET_PRC_DOC_AMT, PRCH_DOC_ITM_NET_PRC_GLBL_AMT, PRCH_DOC_ITM_NET_VAL_DOC_AMT, PRCH_DOC_ITM_NET_VAL_GLBL_AMT, PRCH_DOC_ITM_NET_CNFRM_VAL_DOC_AMT, PRCH_DOC_ITM_NET_CNFRM_VAL_GLBL_AMT, PRCH_DOC_ITM_NET_INVC_VAL_DOC_AMT, PRCH_DOC_ITM_NET_INVC_VAL_GLBL_AMT, PRCH_DOC_ITM_FURTHER_LMT_DOC_AMT, PRCH_DOC_ITM_FURTHER_LMT_GLBL_AMT, PRCH_DOC_ITM_NET_LMT_DOC_AMT, PRCH_DOC_ITM_NET_LMT_GLBL_AMT, PRCH_DOC_ITM_EXPCT_NET_VAL_DOC_AMT, PRCH_DOC_ITM_EXPCT_NET_VAL_GLBL_AMT, PRCH_DOC_ITM_GROSS_PRC_DOC_AMT, PRCH_DOC_ITM_GROSS_PRC_GLBL_AMT, PRCH_DOC_ITM_TAX_DOC_AMT, PRCH_DOC_ITM_TAX_GLBL_AMT, REQ_BUS_PARTNER_ID, GOODS_RCPNT_BUS_PARTNER_ID, BUS_PARTNER_LOC_BUS_PARTNER_ID, SVC_PROVDR_BUS_PARTNER_ID, ITM_CTGY_CD, UNDEF_LMT_IND, PRCH_DOC_ITM_UOM_CD, TAX_CD, PROD_LOGC_SYS_ID, SHOP_CART_ID, SHOP_CART_ITM_ID, DEL_IND, FNL_INVC_RCVE_CD, GOODS_SERVICES_FNL_ENTRY_IND, CNTRCT_ID, CNTRCT_ITM_ID, SPEC_PRCH_ITM_CHAR_CD, PRCH_DOC_ITM_QTY, SCHD_LN_QTY, PRCH_ORG_ID, PRCH_GRP_ID, PARNT_PRCH_DOC_GUID, PUBLIC_SCTR_HIER_TMPL_NM, PUBLIC_SCTR_HNDL_ITM_GUID, PUBLIC_SCTR_EXT_SORT_ID, PUBLIC_SCTR_ITM_PROC_TYP_CNTRL_ID, PUBLIC_SCTR_CFG_KEY_LINE_ITM_ID, PUBLIC_SCTR_ITM_TYP_CD, TERM_PAY_ID, BACKEND_STOR_LOC_ID, BUYER_USR_ID
    FROM GDYR_BI_VWS.SRM_PRCH_DOC_CURR
    WHERE 
        ((%v_CoCdSRM%) %v_VendorFilerSRM%
         AND PRCH_DOC_ITM_ID <> '0'
         AND POST_DT BETWEEN DATE '%v_dateLow_SRM%' AND '%v_dateHigh_SRM%')
 ) END_QUERY 

CLOSE PRIMARY SECONDARY

COM********************************************************************

%v_COMMENT%
COM Import SC data from Snowflake
ACCESSDATA64 CONNECTOR NAME "Snowflake" TO "SRM_SC_CURR.fil" CHARMAX 50 MEMOMAX 100 
 %v_SQL_source%
 SQL_QUERY( 
    SELECT RGN_ORIG_SYS_ID, EFF_DT, EXP_DT, RGN_SBU_ID, BW_ORIG_SYS_ID, SHOP_CART_ID, TRANS_TYP_CD, DISP_SHOP_CART_CRT_DT, SHOP_CART_NM, UPCASE_SHOP_CART_NM, SHOP_CART_CRT_DT, SHOP_CART_CRT_TM, SHOP_CART_CHG_DT, SHOP_CART_CHG_TM, SHOP_CART_CRT_USR_ID, SHOP_CART_CHG_USR_ID, CO_CD, SHOP_CART_CRNCY_ID, SHOP_CART_APRV_NET_VAL_SHOP_CART_CRNCY_AMT , SHOP_CART_APRV_NET_VAL_GLBL_AMT , SHOP_CART_ITM_NET_VAL_SHOP_CART_CRNCY_AMT , SHOP_CART_ITM_NET_VAL_GLBL_AMT , SHOP_CART_ITM_NET_PRC_SHOP_CART_CRNCY_AMT , SHOP_CART_ITM_NET_PRC_GLBL_AMT , SHOP_CART_ITM_UOM_CD, SHOP_CART_ITM_UOM_QTY, SHOP_CART_ITM_UOM_PRC_QTY, SHOP_CART_ITM_TAX_SHOP_CART_CRNCY_AMT , SHOP_CART_ITM_TAX_GLBL_AMT , SHOP_CART_ITM_LMT_SHOP_CART_CRNCY_AMT , SHOP_CART_ITM_LMT_GLBL_AMT , SHOP_CART_ITM_GROSS_PRC_SHOP_CART_CRNCY_AMT , SHOP_CART_ITM_GROSS_PRC_GLBL_AMT , SHOP_CART_ITM_EXPCT_VAL_SHOP_CART_CRNCY_AMT , SHOP_CART_ITM_EXPCT_VAL_GLBL_AMT , APRV_BUS_PARTNER_ID, FRST_APRV_DT, FRST_APRV_DY_QTY, FRST_APRV_TM, FRST_APRV_TM_QTY, LST_APRV_DT, LST_APRV_DY_QTY, LST_APRV_TM, LST_APRV_TM_QTY, GR_IND, INVC_RCPT_IND, SHOP_CART_QTY, SHOP_CART_ITM_CRT_DT, SHOP_CART_ITM_CHG_DT, SHOP_CART_ITM_CRT_USR_ID, SHOP_CART_ITM_CHG_USR_ID, PROD_DESC, SHOP_CART_ITM_ID, SHOP_CART_ITM_CTGY_CD, MFG_PART_ID, MFG_VEND_ID, CATL_ID, PROD_CTGY_CD, RDD_DT, RDD_QTY, BACKEND_FOLLOW_ON_DOC_ID, BACKEND_FOLLOW_ON_DOC_ITM_ID, GOODS_RCPNT_BUS_PARTNER_ID, TAX_CD, UNDEF_LMT_IND, DEL_IND, FNL_INVC_RCVE_IND, GOODS_SERVICES_FNL_ENTRY_IND, CNTRCT_ID, CNTRCT_ITM_ID, ORG_UNIT_ID, PRCH_ORG_ID, PRCH_GRP_ID, SPEC_PRCH_ITM_CHAR_CD, SHOP_CART_ITM_QTY, REJ_IND, GL_ACCT_ID, CNTRL_AREA_ID, COST_CNTR_CD, SNGL_SRC_IND, ALREADY_SRC_IND, IMMDT_STOR_IND, ORD_DIRECT_IND, DVRS_IND, INCOTERM_CD, INCOTERM_DESC, DISTR_PCT, BACKEND_STOR_LOC_ID, EMRGNCY_STOR_PO_IND, HANDS_FREE_IND
    FROM GDYR_BI_VWS.SRM_SHOP_CART_CURR
    WHERE 
        ((%v_CoCdSRM%) %v_VendorFilerSRM%
         AND BACKEND_FOLLOW_ON_DOC_ID <> ''
         AND DISP_SHOP_CART_CRT_DT BETWEEN DATE '%v_dateLow_SC%' AND '%v_dateHigh_SC%')
 ) END_QUERY 
